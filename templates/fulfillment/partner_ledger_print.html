<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>{{ partner.name }}_ì›ì¥</title>
    <style>
        body { font-family: "Malgun Gothic", sans-serif; font-size: 11pt; color: #000; margin: 0; padding: 20px; }
        
        /* í™”ë©´ì—ëŠ” ë³´ì´ì§€ë§Œ ì¸ì‡„í•  ë•ŒëŠ” ìˆ¨ê¸°ëŠ” í´ë˜ìŠ¤ */
        @media print {
            .no-print { display: none !important; }
            body { padding: 0; }
        }

        .container { width: 100%; max-width: 210mm; margin: 0 auto; } /* A4 ë„ˆë¹„ */
        
        /* ìƒë‹¨ í—¤ë” */
        .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #000; padding-bottom: 10px; }
        .header h1 { margin: 0; font-size: 24pt; letter-spacing: 2px; }
        .header .date-range { font-size: 12pt; margin-top: 10px; }

        /* ì •ë³´ í…Œì´ë¸” */
        .info-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        .info-table th { text-align: left; padding: 5px 10px; background-color: #f0f0f0; border: 1px solid #ccc; width: 15%; }
        .info-table td { padding: 5px 10px; border: 1px solid #ccc; width: 35%; }

        /* ë©”ì¸ ê±°ë˜ ë‚´ì—­ í…Œì´ë¸” */
        .ledger-table { width: 100%; border-collapse: collapse; margin-bottom: 30px; }
        .ledger-table th, .ledger-table td { border: 1px solid #000; padding: 8px; font-size: 10pt; }
        .ledger-table th { background-color: #eee; text-align: center; height: 30px; }
        .ledger-table td { height: 25px; }
        
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-left { text-align: left; }
        .fw-bold { font-weight: bold; }

        /* í•©ê³„ ìš”ì•½ ë°•ìŠ¤ */
        .summary-box { border: 2px solid #000; padding: 15px; margin-top: 10px; page-break-inside: avoid; }
        .summary-table { width: 100%; }
        .summary-table th { text-align: left; font-size: 11pt; }
        .summary-table td { text-align: right; font-size: 12pt; font-weight: bold; }

        /* í•˜ë‹¨ ë²„íŠ¼ (ì¸ì‡„ ì‹œ ìˆ¨ê¹€) */
        .btn-area { text-align: center; margin-bottom: 20px; padding: 10px; background: #f8f9fa; border: 1px solid #ddd; }
        .btn { padding: 8px 20px; background-color: #2c3e50; color: white; border: none; cursor: pointer; font-size: 14px; border-radius: 4px; text-decoration: none; display: inline-block; }
        .btn:hover { background-color: #1a252f; }
    </style>
</head>
<body>

    <div class="no-print btn-area">
        <button class="btn" onclick="window.print()">ğŸ–¨ï¸ ì¸ì‡„í•˜ê¸°</button>
        <button class="btn" onclick="window.close()" style="background-color: #95a5a6; margin-left: 10px;">ë‹«ê¸°</button>
    </div>

    <div class="container">
        <div class="header">
            <h1>ê±°ë˜ì²˜ ì›ì¥</h1>
            <div class="date-range">ì¡°íšŒ ê¸°ê°„: {{ start_date|date:"Yë…„ mì›” dì¼" }} ~ {{ end_date|date:"Yë…„ mì›” dì¼" }}</div>
        </div>

        <table class="info-table">
            <tr>
                <th>ìƒí˜¸ëª…</th>
                <td>{{ partner.name }}</td>
                <th>ë‹´ë‹¹ì</th>
                <td>{{ partner.contact_person|default:"-" }}</td>
            </tr>
            <tr>
                <th>ì—°ë½ì²˜</th>
                <td>{{ partner.phone|default:"-" }}</td>
                <th>ì´ë©”ì¼</th>
                <td>{{ partner.email|default:"-" }}</td>
            </tr>
        </table>

        <table class="ledger-table">
            <thead>
                <tr>
                    <th width="12%">ì¼ì</th>
                    <th width="10%">êµ¬ë¶„</th>
                    <th>ì ìš”</th>
                    <th width="15%">ë§¤ì¶œ/ì²­êµ¬ (+)</th>
                    <th width="15%">ì…ê¸ˆ/ì§€ê¸‰ (-)</th>
                    <th width="15%">ì”ì•¡</th>
                </tr>
            </thead>
            <tbody>
                <tr style="background-color: #fafafa;">
                    <td class="text-center">-</td>
                    <td class="text-center">ì´ì›”</td>
                    <td>ì „ì¼ ì”ì•¡ ì´ì›” (Carry-over)</td>
                    <td class="text-right">-</td>
                    <td class="text-right">-</td>
                    <td class="text-right fw-bold">{{ carry_over_balance|floatformat:0 }}</td>
                </tr>

                {% for t in transactions %}
                <tr>
                    <td class="text-center">{{ t.date|date:"Y-m-d" }}</td>
                    <td class="text-center">{{ t.type }}</td>
                    <td class="text-left">{{ t.desc }}</td>
                    
                    <td class="text-right">
                        {% if t.amount > 0 %}{{ t.amount|floatformat:0 }}{% else %}-{% endif %}
                    </td>
                    <td class="text-right">
                        {% if t.amount < 0 %}{{ t.amount|stringformat:"d"|slice:"1:" }}{% else %}-{% endif %}
                    </td>
                    
                    <td class="text-right">{{ t.balance|floatformat:0 }}</td>
                </tr>
                {% endfor %}

                {% if not transactions %}
                <tr>
                    <td colspan="6" class="text-center" style="padding: 20px; color: #888;">ì¡°íšŒ ê¸°ê°„ ë‚´ ê±°ë˜ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td>
                </tr>
                {% endif %}
            </tbody>
        </table>

        <div class="summary-box">
            <table class="summary-table">
                <tr>
                    <th width="70%">â‘  ê¸°ì´ˆ ì´ì›” ì”ì•¡</th>
                    <td>{{ carry_over_balance|floatformat:0 }}</td>
                </tr>
                <tr>
                    <th>â‘¡ ê¸°ê°„ ë‚´ í•©ê³„ (ë§¤ì¶œ/ì²­êµ¬)</th>
                    <td>+ {{ total_sales|floatformat:0 }}</td>
                </tr>
                <tr>
                    <th>â‘¢ ê¸°ê°„ ë‚´ í•©ê³„ (ì…ê¸ˆ/ì§€ê¸‰)</th>
                    <td>- {{ total_paid|floatformat:0 }}</td>
                </tr>
                <tr><td colspan="2"><hr style="border-top: 1px solid #000; margin: 10px 0;"></td></tr>
                <tr>
                    <th style="font-size: 14pt;">â‘£ ìµœì¢… ì”ì•¡</th>
                    <td style="font-size: 14pt;">{{ final_balance|floatformat:0 }}</td>
                </tr>
            </table>
        </div>

        <div style="margin-top: 30px; text-align: center; font-size: 10pt; color: #555;">
            ì¶œë ¥ì¼: {{ today|date:"Y-m-d H:i" }} | PACIFIC PROUD ERP
        </div>
    </div>

</body>
</html>