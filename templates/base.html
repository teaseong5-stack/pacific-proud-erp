<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> <title>PACIFIC PROUD ERP</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" />

    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>

    <style>
        body { font-family: 'Malgun Gothic', sans-serif; background-color: #f8f9fa; overflow-x: hidden; }
        
        /* 사이드바 스타일 */
        .sidebar { 
            min-width: 260px; 
            max-width: 260px;
            min-height: 100vh; 
            background-color: #2c3e50; 
            color: #ecf0f1; 
            position: fixed; /* 사이드바 고정 */
            left: 0; top: 0;
            z-index: 1000;
            overflow-y: auto;
        }
        .sidebar a { color: #bdc3c7; text-decoration: none; display: block; padding: 10px 20px; font-size: 0.95rem; }
        .sidebar a:hover { background-color: #34495e; color: #fff; }
        .sidebar .category { font-size: 0.75rem; text-transform: uppercase; color: #95a5a6; padding: 15px 20px 5px; font-weight: bold; letter-spacing: 1px; }
        .sidebar .brand { font-size: 1.3rem; font-weight: bold; padding: 20px; text-align: center; color: #fff; border-bottom: 1px solid #34495e; word-break: keep-all;}
        
        /* 메인 컨텐츠 영역 (사이드바 너비만큼 띄우기) */
        .main-content-wrapper {
            margin-left: 260px; /* 사이드바 너비 */
            padding: 30px;
            width: calc(100% - 260px);
        }

        /* 테이블 틀 고정 스타일 */
        .card-body.p-0 { max-height: 75vh; overflow-y: auto; }
        .table thead th { position: sticky; top: 0; z-index: 2; background-color: #e9ecef; box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.1); border-top: none; }
    </style>
</head>
<body>

    <nav class="sidebar">
        <div class="brand">
            <i class="bi bi-globe-asia-australia me-2"></i>PACIFIC PROUD
        </div>

        <div class="category">메인 (Main)</div>
        <a href="{% url 'fulfillment:dashboard' %}"><i class="bi bi-speedometer2 me-2"></i> CEO 대시보드</a>
		<a href="{% url 'fulfillment:worklog_list' %}"><i class="bi bi-journal-text me-2"></i> 업무 일지</a>

        <div class="category">물류 관리 (Logistics)</div>
        {% if perms.fulfillment.view_inventory %}
        <a href="{% url 'fulfillment:inbound_create' %}"><i class="bi bi-box-seam me-2"></i> 입고 등록 (바코드)</a>
        <a href="{% url 'fulfillment:purchase_list' %}"><i class="bi bi-cart-plus me-2"></i> 발주/매입 관리</a>
        <a href="{% url 'fulfillment:order_list' %}"><i class="bi bi-truck me-2"></i> 주문/출고 관리</a>
        <a href="{% url 'fulfillment:inventory_list' %}"><i class="bi bi-boxes me-2"></i> 실시간 재고 조회</a>
        {% endif %}

        <div class="category">재무/회계 (Finance)</div>
        {% if perms.fulfillment.view_expense %}
        <a href="{% url 'fulfillment:monthly_report' %}"><i class="bi bi-file-earmark-bar-graph me-2"></i> 월간 손익보고서</a>
        <a href="{% url 'fulfillment:expense_list' %}"><i class="bi bi-cash-coin me-2"></i> 비용/지출 내역</a>
		<a href="{% url 'fulfillment:bank_list' %}"><i class="bi bi-bank me-2"></i> 법인 계좌 관리</a>
        {% endif %}

        <div class="category">인사/급여 (HR)</div>
        {% if perms.fulfillment.view_employee %}
        <a href="{% url 'fulfillment:employee_list' %}"><i class="bi bi-people me-2"></i> 직원 명부</a>
        <a href="{% url 'fulfillment:payroll_list' %}"><i class="bi bi-wallet2 me-2"></i> 급여 대장</a>
        {% endif %}

        <div class="category">기초 정보 (Master)</div>
        <a href="{% url 'fulfillment:partner_list' %}"><i class="bi bi-building me-2"></i> 거래처 관리</a>
        <a href="{% url 'fulfillment:product_list' %}"><i class="bi bi-tags me-2"></i> 상품 관리</a>
        
        <div class="mt-5 px-3 mb-4 text-center">
            <a href="{% url 'fulfillment:company_update' %}" class="btn btn-outline-light btn-sm w-100 mb-2">
                <i class="bi bi-gear-fill me-1"></i> 회사 정보 설정
            </a>
            {% if user.is_superuser %}
            <a href="/admin/" target="_blank" class="btn btn-danger btn-sm w-100">
                <i class="bi bi-shield-lock-fill me-1"></i> 관리자(Admin) 페이지
            </a>
            {% endif %}
        </div>

        {% if user.is_authenticated %}
        <div class="mt-3 pt-3 border-top border-secondary mx-3">
            <div class="d-flex align-items-center mb-2 text-white">
                <div class="bg-success rounded-circle d-flex justify-content-center align-items-center me-2" style="width: 35px; height: 35px;">
                    {{ user.username|slice:":1"|upper }}
                </div>
                <div>
                    <div class="fw-bold small">{{ user.username }} 님</div>
                    <div class="text-muted" style="font-size: 0.7rem;">접속중</div>
                </div>
            </div>
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-sm btn-outline-danger w-100">
                    <i class="bi bi-box-arrow-right"></i> 로그아웃
                </button>
            </form>
            
            <div class="text-center mt-2">
                <a href="{% url 'fulfillment:delete_account' %}" class="text-secondary small text-decoration-none">회원탈퇴</a>
            </div>
        </div>
        {% else %}
        <div class="mt-5 px-3 text-center">
            <a href="{% url 'login' %}" class="btn btn-primary w-100">로그인 필요</a>
        </div>
        {% endif %}
    </nav>

    <div class="main-content-wrapper">
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow-sm" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}

        {% block content %}
        {% endblock %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <script>
        $(document).ready(function() {
            // 검색 가능한 드롭다운 적용
            $('.search-select').select2({
                theme: 'bootstrap-5',
                width: '100%',
                placeholder: '검색어 입력 또는 선택',
                allowClear: true
            });
        });
    </script>
</body>
</html>